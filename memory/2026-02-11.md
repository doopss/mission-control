# 2026-02-11 Session Notes

## Kimi k2.5 Model Configuration (RESOLVED)

**Goal:** Switch OpenClaw from Sonnet to Kimi k2.5 (Moonshot API)

### Key Learnings - Kimi/Moonshot Configuration

**Correct configuration structure:**
```json
{
  "models": {
    "providers": {
      "kimi": {
        "baseUrl": "https://api.moonshot.cn/v1",
        "apiKey": "sk-...",
        "api": "openai-completions",  // CRITICAL - must specify API type!
        "models": [
          {
            "id": "moonshot-v1-128k",  // Use actual Moonshot model ID, not "k2.5"
            "name": "Kimi k2.5",
            "contextWindow": 128000,
            "maxTokens": 4096
          }
        ]
      }
    }
  },
  "agents": {
    "defaults": {
      "model": {
        "primary": "kimi/moonshot-v1-128k",  // provider/modelId format
        "fallbacks": ["anthropic/claude-opus-4-5"]
      }
    }
  }
}
```

### Mistakes Made (Don't Repeat)

1. **❌ DON'T put apiKey in auth.profiles** - Auth profiles only accept `provider`, `mode`, `email`. API keys go in `models.providers.<name>.apiKey`

2. **❌ DON'T forget the `api` field** - Without it: `Error: No API provider registered for api: undefined`. Kimi uses `"api": "openai-completions"`

3. **❌ DON'T use marketing names as model IDs** - Use actual API model IDs (e.g., `moonshot-v1-128k` not `k2.5`)

### Alex's Kimi API Key
- Key: `sk-04HKgPHorzclNDuvtnFkrNL5lVYxIjcqDVihbyxhjRIrAZhr`
- Platform: https://platform.moonshot.cn/

### Remediation Plan (If Model Breaks)
1. Automatic fallback to Opus (already configured)
2. Quick fix: Edit primary model in config
3. Use backup: `cp ~/.openclaw/openclaw.json.backup ~/.openclaw/openclaw.json`
4. Temporary override: `/model anthropic/claude-sonnet-4-5`

---

## Pet Psychic Instagram Outreach

**Status:** BLOCKED - Instagram login failing for @PetPsychicApp

**Automation built:** `~/.openclaw/workspace/pet-psychic-outreach/`
- send-dms.ts
- Templates and guides

**Credentials attempted:** 
- Username: PetPsychicApp
- Password: u&LKW=8,5"1
- Result: Login failed - account may not exist or credentials incorrect

**Next steps:**
1. Verify @PetPsychicApp account exists or create it
2. Confirm credentials
3. Test login manually first
4. Then test automation with DM to @schlemyy

---

## ✅ Kimi WORKING (5:12 PM EST)

**Final fix:** Wrong API URL!
- ❌ `api.moonshot.cn` (old/China?)
- ✅ `api.moonshot.ai` (correct international endpoint)

**Working API key:** `sk-QNG6dQhXJu6H1PTYQTKDxuCeLw9aNBM80rmQAkqKLRNSPO3O`

**Final correct config:**
```json
"kimi": {
  "baseUrl": "https://api.moonshot.ai/v1",
  "apiKey": "sk-QNG6dQhXJu6H1PTYQTKDxuCeLw9aNBM80rmQAkqKLRNSPO3O",
  "api": "openai-completions",
  "models": [{
    "id": "moonshot-v1-128k",
    "name": "Kimi k2.5",
    "contextWindow": 128000,
    "maxTokens": 4096
  }]
}
```

**Lesson learned:** Always verify API base URL from official docs - moonshot.ai vs moonshot.cn are different!

---

## Config Editing Tips

- Use `gateway config.get` to see current config and validation status
- Use `gateway config.schema` to see valid fields
- `valid: true` + `issues: []` = config is good
- After editing, run `openclaw gateway restart`
- Check `~/.openclaw/logs/gateway.err.log` for errors
